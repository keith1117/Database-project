{% extends 'layout.html' %}
{% block title %}Search Flights{% endblock %}
{% block content %}
<h1>Search Flights</h1>
<form method="POST">
  From <input name="depart" value="{{ dep or '' }}" maxlength="3" style="text-transform:uppercase">
  To <input name="arrive" value="{{ arr or '' }}" maxlength="3" style="text-transform:uppercase">
  Date <input type="date" name="date" value="{{ date or '' }}">
  <button>Search</button>
</form>
<hr>
<table border="1" cellpadding="6">
  <tr>
    <th>Airline</th><th>Flight</th><th>Dep Time</th><th>Arr Time</th><th>From</th><th>To</th><th>Price</th><th>Status</th>
    {% if session.get('role')=='customer' %}<th>Buy</th>{% endif %}
  </tr>
  {% for f in rows %}
  <tr>
    <td>{{ f.airline_name }}</td>
    <td>{{ f.flight_number }}</td>
    <td>{{ f.departure_date_time }}</td>
    <td>{{ f.arrival_date_time }}</td>
    <td>{{ f.departure_airport }}</td>
    <td>{{ f.arrival_airport }}</td>
    <td>${{ '%.2f'|format(f.base_price) }}</td>
    <td>{{ f.status }}</td>
    {% if session.get('role')=='customer' %}
    <td>
      <form method="POST" action="{{ url_for('customer_purchase') }}">
        <input type="hidden" name="airline_name" value="{{ f.airline_name }}">
        <input type="hidden" name="flight_number" value="{{ f.flight_number }}">
        <input type="hidden" name="departure_date_time" value="{{ f.departure_date_time }}">
        <input name="name_on_card" placeholder="Name on Card" required>
        <select name="card_type"><option>Credit</option><option>Debit</option></select>
        <input name="card_number" placeholder="Card Number" required>
        <input type="date" name="expiration_date" required>
        <button>Buy</button>
      </form>
    </td>
    {% endif %}
  </tr>
  {% endfor %}
</table>
{% endblock %}