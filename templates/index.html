{% extends 'layout.html' %}
{% block title %}Home{% endblock %}
{% block content %}
<h1>Public Flight Search</h1>
<form method="POST" action="{{ url_for('public_search') }}">
  <p style="margin:6px 0">
    <label><input type="radio" name="trip_type" value="oneway"
      {% if trip_type != 'round' %}checked{% endif %}> One-way</label>
    &nbsp;&nbsp;
    <label><input type="radio" name="trip_type" value="round"
      {% if trip_type == 'round' %}checked{% endif %}> Round trip</label>
  </p>

  From <input name="depart" maxlength="3" style="text-transform:uppercase"
              value="{{ dep or '' }}" required>
  To <input name="arrive" maxlength="3" style="text-transform:uppercase"
            value="{{ arr or '' }}" required>
  Depart <input type="date" name="date" value="{{ date or '' }}" required>

  <span id="return_wrap" {% if trip_type != 'round' %}style="display:none"{% endif %}>
    &nbsp;&nbsp;Return <input type="date" name="return_date" value="{{ return_date or '' }}">
  </span>

  <button>Search</button>
</form>

{% if rows %}
  <h3>Outbound</h3>
  {% include "partials/_flight_table.html" with context %}
{% endif %}

{% if rows_back %}
  <h3>Return</h3>
  {% set rows = rows_back %}
  {% include "partials/_flight_table.html" with context %}
{% endif %}

<script>
  document.addEventListener('change', e => {
    if (e.target.name === 'trip_type') {
      document.getElementById('return_wrap').style.display =
        e.target.value === 'round' ? 'inline-block' : 'none';
    }
  });
</script>
{% endblock %}